
# 装饰器

因为最近对 [NestJS](https://nestjs.bootcss.com/) 比较感兴趣看到很多装饰器的写法，所有想要深入学习一下。

[装饰器](https://es6.ruanyifeng.com/#docs/decorator)是一个还处于草案中的特性，目前没有直接支持该语法的环境，但是可以通过 babel 之类的进行转换为旧语法来实现效果，所以在TypeScript中，可以放心的使用@Decorator。

## 简介

装饰器（Decorator）用来增强 JavaScript 类（Class）的功能，许多面向对象的语言都有这种语法，未来或许会将其引入了 ECMAScript 标准中。

装饰器是一种函数，可以写成`@+函数名`，主要可以装饰四种类型的值。
- 类
- 类的属性
- 类的方法
- 属性存取器（accessor）

下面的例子是装饰器放在类名和类方法名之前，大家可以感受一下写法。

``` ts
@frozen class Foo {
  @configurable(false)
  @enumerable(true)
  method() {}

  @throttle(500)
  expensiveMethod() {}
}
```
上面代码一共使用了四个装饰器，一个用在类本身（@frozen），另外三个用在类方法（@configurable()、@enumerable()、@throttle()）。它们不仅增加了代码的可读性，清晰地表达了意图，而且提供一种方便的手段，增加或修改类的功能。

## 装饰器API函数

## 类的装饰
``` js
@testable
class MyTestableClass {
  // ...
}

function testable(target) {
  target.isTestable = true;
}

MyTestableClass.isTestable // true
```

## 应用于函数

装饰器只能用于类和类的方法，不能用于函数，因为存在函数提升(如果一定要装饰函数，可以使用高阶函数直接执行)。

``` js
function doSomething(name) {
  console.log('Hello, ' + name);
}

function loggingDecorator(wrapped) {
  return function() {
    console.log('Starting');
    const result = wrapped.apply(this, arguments);
    console.log('Finished');
    return result;
  }
}

const wrapped = loggingDecorator(doSomething);
```

## 参考
- [ES6-装饰器](https://es6.ruanyifeng.com/#docs/decorator)
- [Javascript装饰器的妙用](https://juejin.cn/post/6844903635168526343)