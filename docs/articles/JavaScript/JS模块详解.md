# JS 模块系统

模块化的意义：

将代码拆分成独立的块，然后再把这些块使用模块模式连接起来实现不同的功能。

就像小时候玩的拼图一样，不同的拼图组合在一起就可以拼成任意的形状。

这种模式的背后思想也很简单：把逻辑分块、各自封装，相互独立，同时自行决定引入执行那些外部模块以及暴露自身的那些模块。

这个基本的思想是所有的 JavaScript 模块系统的基础。

## 模块依赖

模块系统的核心是管理依赖，本地模块向模块系统声明一组外部模块，这些模块是当前模块正常运行的必需。

比如一个吃饭的模块，可能需要的依赖有：

- 菜单模块
- 餐具模块
- 支付模块
- ....

当你想要使用这个吃饭模块时，这些模块就是它的依赖。

**入口模块**：相互依赖的模块必须制定一个模块作为入口（entry point），这个文件是代码执行的起点。

**模块加载**：只有该模块需要的所有依赖都被加载完成之后，才可以执行入口模块。

比如吃饭模块，必须等菜单、餐具、支付模块都加载完成之后才能开始执行“吃饭”的方法，而入口就是菜单模块。

### 异步依赖

模块加载依赖默认是按照依赖的倒序执行的，比如：

![image-20210220120039972](C:\Users\boao\AppData\Roaming\Typora\typora-user-images\image-20210220120039972.png)

上面模块的执行顺序是：

```js
<script src="moduleE.js"></script>
<script src="moduleD.js"></script>
<script src="moduleC.js"></script>
<script src="moduleB.js"></script>
<script src="moduleA.js"></script>
```

### 动态依赖

- 闭包

- IIFE
- CommonJS
- AMD
- UMD
- ESmodule
- 揺树（tree-shaking）

## 参考

- [前端模块化详解](https://juejin.cn/post/6844903744518389768#heading-47)
